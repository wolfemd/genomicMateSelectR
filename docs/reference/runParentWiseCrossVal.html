<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run parent-wise cross-validation — runParentWiseCrossVal • genomicMateSelectR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run parent-wise cross-validation — runParentWiseCrossVal"><meta property="og:description" content='Assess the accuracy of predicted previously unobserved crosses.
Specifically the accurracy predicting the mean and variance among family
members in breeding and total genetic values. The cross-validation procedure
implemented is described in detail in the manuscript:
https://www.biorxiv.org/content/10.1101/2021.01.05.425443v1, see "Details" below.
User supplies a pedigree, haplotypes and other inputs.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">genomicMateSelectR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/non_additive_models.html">Genomic predictions with non-additive effects</a>
    </li>
    <li>
      <a href="../articles/start_here.html">Getting started predicting crosses</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/wolfemd/genomicMateSelectR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run parent-wise cross-validation</h1>
    <small class="dont-index">Source: <a href="https://github.com/wolfemd/genomicMateSelectR/blob/HEAD/R/parentWiseCrossVal.R" class="external-link"><code>R/parentWiseCrossVal.R</code></a></small>
    <div class="hidden name"><code>runParentWiseCrossVal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Assess the accuracy of predicted previously unobserved crosses.
Specifically the accurracy predicting the mean and variance among family
members in breeding and total genetic values. The cross-validation procedure
implemented is described in detail in the manuscript:
<a href="https://www.biorxiv.org/content/10.1101/2021.01.05.425443v1" class="external-link">https://www.biorxiv.org/content/10.1101/2021.01.05.425443v1</a>, see "Details" below.
User supplies a pedigree, haplotypes and other inputs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">runParentWiseCrossVal</span><span class="op">(</span>
  <span class="va">nrepeats</span>,
  <span class="va">nfolds</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">modelType</span>,
  ncores <span class="op">=</span> <span class="fl">1</span>,
  nBLASthreads <span class="op">=</span> <span class="cn">NULL</span>,
  outName <span class="op">=</span> <span class="cn">NULL</span>,
  ped <span class="op">=</span> <span class="va">ped</span>,
  gid <span class="op">=</span> <span class="st">"GID"</span>,
  <span class="va">blups</span>,
  <span class="va">dosages</span>,
  <span class="va">grms</span>,
  <span class="va">haploMat</span>,
  <span class="va">recombFreqMat</span>,
  <span class="va">selInd</span>,
  SIwts <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>nrepeats</dt>
<dd><p>number of repeats</p></dd>
<dt>nfolds</dt>
<dd><p>number of folds</p></dd>
<dt>seed</dt>
<dd><p>integer, make the parent trait-test folds reproducible</p></dd>
<dt>modelType</dt>
<dd><p>string, "A", "AD", "DirDom". modelType="A": additive-only,
predicts mean and variances for breeding values [BVs]). modelType="AD": the
"classic" add-dom model, predicts family mean and variance for breeding
value based on allele sub. effects. Predicts family variance-covariances
for TGVs (BVs+DDs). Doesn't predict family mean TGV. modelType="DirDom":
the "genotypic" add-dom model with prop. homozygous fit as a fixed-effect,
to estimate a genome-wide inbreeding effect. obtains add-dom effects,
computes allele sub effects (\(\alpha = a + d(q-p)\)) predicts family
mean and covars for BVs using allele sub. effects predicts covars AND the
means for TGVs using directly the add-dom effects. estimated linear effect
of overall homozygosity (b), interpreted as inbreeding depression or
heterosis depending on its direction relative to each trait (Xiang et al.
2016). The estimated genome-wide fixed-effect of homozygosity (b) can be
incorporated into the predicted means and variances by first dividing by
the number of effects (p) and subtracting that value from the vector of
dominance effects (\(d\ast\)), to get \(d=d*-\frac{b}{p}\)</p></dd>
<dt>ncores</dt>
<dd><p>number of cores</p></dd>
<dt>nBLASthreads</dt>
<dd><p>number of cores for each worker to use for multi-thread BLAS</p></dd>
<dt>outName</dt>
<dd><p>default=NULL (optional), name and path to save outputs</p></dd>
<dt>ped</dt>
<dd><p>data.frame, 3 columns, "GID" (or <code>gid</code>), "sireID", "damID"
for male and female parent, respectively.</p></dd>
<dt>gid</dt>
<dd><p>string variable name used for genotype ID's in e.g. <code>blups</code> (default="GID")</p></dd>
<dt>blups</dt>
<dd><p>nested data.frame with list-column "blups" containing</p></dd>
<dt>dosages</dt>
<dd><p>dosage matrix. required only for modelType=="DirDom".
Assumes SNPs coded 0, 1, 2. Nind rows x Nsnp
cols, numeric matrix, with rownames and colnames to indicate SNP/ind ID</p></dd>
<dt>grms</dt>
<dd><p>list of genomic relation matrices (GRMs, aka kinship matrices).
Any genotypes in the GRMs get predicted with, or without phenotypes.
Each element is named either A or D. Matrices supplied must match
required by A, AD and DirDom models. e.g. grms=list(A=A,D=D).</p></dd>
<dt>haploMat</dt>
<dd><p>matrix of phased haplotypes, 2 rows per sample, cols = loci, 0,1, rownames assumed to contain GIDs with a suffix, separated by "_" to distinguish haplotypes</p></dd>
<dt>recombFreqMat</dt>
<dd><p>a square symmetric matrix with values = (1-2*c1), where c1=matrix of expected recomb. frequencies. The choice to do 1-2c1 outside the function was made for computation efficiency; every operation on a big matrix takes time.</p></dd>
<dt>selInd</dt>
<dd><p>logical, TRUE/FALSE, selection index accuracy estimates,
requires input weights via <code>SIwts</code></p></dd>
<dt>SIwts</dt>
<dd><p>required if <code>selInd=FALSE</code>, named vector of selection
index weights, names match the "Trait" variable in <code>blups</code></p></dd>
<dt>...</dt>
<dd></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>tibble, one row, two list columns (basically a named two-element
list of lists): <code>meanPredAccuracy</code> and
<code>varPredAccuracy</code> both contain tibbles. Column "AccuracyEst" for
family-size weighted prediction accuracy estimates. If <code>selInd=TRUE</code>then corresponding accuracy labelled "SELIND" in "Trait" columns.
The column "predVSobs" is a list of tibbles each containing the paired
predicted and observed values for the given repeat-fold-trait.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>First, define a vector, \(\boldsymbol{P}\) of the parents listed in the
pedigree. Define also a second vector \(\boldsymbol{C}\) listing the
genotypes (clones) in the pedigree, including the parents
(\(\boldsymbol{P}\subset\boldsymbol{C}\)).</p>
<p>Conducts <code>nrepeats</code> replications of the following procedure:</p>
<ol><li><p>Define parent-wise cross-validation folds: randomly assign the
     parents in \(\boldsymbol{P}\) into \(\textit{k}\)-folds.
     \(\boldsymbol{P}_{TST}^k\), the list of "test" parents in the
     \(\textit{k}\)th-fold.</p></li>
<li><p>For each of the <em>k</em>-folds (set of "test" parents), divide
     the clones vector \(\boldsymbol{C}\)into two mutually exclusive sets:
      "training" (\(\boldsymbol{C}_{TRN}\)) and "validation"
      (\(\boldsymbol{C}_{VLD}\)). From the set \(\boldsymbol{C}_{TRN}\),
      we exclude all descendants (offspring, grandchildren,
      great grandchildren, etc.) of \(\boldsymbol{P}_{TST}^k\).
      We include the \(\boldsymbol{P}_{TST}^k\) themselves
      (phenotyping the parents before predicting their offspring) and any
      non-descendents. Define \(\boldsymbol{C}_{VLD}\) simply as the set
      difference between \(\boldsymbol{C}\) and \(\boldsymbol{C}_{TRN}\).</p></li>
<li><p>Estimate marker effects independently by fitting
     mixed-models (see section
below for further details) to \(\boldsymbol{C}_{VLD}\) and
\(\boldsymbol{C}_{TRN}\) corresponding to each
\(\boldsymbol{P}_{TST}^k\).</p></li>
<li><p>For each \(\boldsymbol{P}_{TST}^k\),
define the set of crosses to predict, \(\boldsymbol{X}_{toPred}^k\) to
include any of the 462 actual families (sire-dam pairs) in the pedigree, in
which the \(\boldsymbol{P}_{TST}^k\) were involved. By construction, the
real family members that have been observed for each of the
\(\boldsymbol{X}_{toPred}^k\) were excluded from the model used to get
marker effects for \(\boldsymbol{C}_{TRN}\), and included in the model for
\(\boldsymbol{C}_{VLD}\). Predict the means, variances and covariances for
each focal trait in each cross, \(\boldsymbol{X}_{toPred}^k\) using the
\(\boldsymbol{C}_{TRN}\) marker effects only.</p></li>
<li><p>For each family in
\(\boldsymbol{X}_{toPred}^k\), using all existing family members, compute
the sample means, variances and covariances for <strong>GEBV</strong> and
<strong>GETGV</strong> as predicted by the \(\boldsymbol{C}_{VLD}\) marker effects.</p></li>
<li><p>Calculate the accuracy of prediction for each mean
(\(\overset{\mu_{T}}{\textbf{cor}}_{BV}\),
\(\overset{\mu_{T}}{\textbf{cor}}_{TGV}\)), variance
(\(\overset{\sigma^2_{t=t}}{\textbf{cor}}_{BV}\),
\(\overset{\sigma^2_{t=t}}{\textbf{cor}}_{TGV}\)) and covariance
(\(\overset{\sigma_{t \neq t}}{\textbf{cor}}_{BV}\),
\(\overset{\sigma_{t \neq t}}{\textbf{cor}}_{TGV}\))  in terms of both
<strong>BV </strong>and <strong>TGV</strong>. For \(\overset{\mu_{T}}{\textbf{cor}}\) we
used the Pearson correlation between predicted and sample mean
<strong>GEBV/GETGV</strong>. For \(\overset{\sigma^2_{t=t}}{\textbf{cor}}\) and
\(\overset{\sigma^2_{t\neq t}}{\textbf{cor}}\), only families with greater
than two members were able to be included, and we weighted the correlation
between the predicted and sample (co)variance of <strong>GEBV/GETGV</strong>
according to the family size (R <strong>package</strong>::<em>function</em>
<strong>psych</strong>::<em>cor.wt</em>). For sake of comparison, we also include
accuracies in the supplement where predicted values are correlated to
phenotypic (rather than genomic-predicted) BLUPs, e.g.
\(\overset{\mu_{T}}{\textbf{cor}}_{BV,BLUP}\),
\(\overset{\mu_{T}}{\textbf{cor}}_{TGV,BLUP}\), etc.</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other CrossVal: 
<code><a href="runCrossVal.html">runCrossVal</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marnin Wolfe.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

