<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Genomic Mate Selection • genomicMateSelectR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Genomic Mate Selection">
<meta property="og:description" content="Predict the usefulness of a cross. Multi-trait selection index 
  mean and variance prediction based on parental haplotypes, a genetic map, 
  and marker effects. Implement cross-validation procedures to estimate the 
  accuracy predicting the performance (breeding value, total genetic value 
  including dominance) of previously unobserved individuals as well as cross 
  means and variances. Successor package to predCrossVar.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">genomicMateSelectR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/non_additive_models.html">Genomic predictions with non-additive effects</a>
    </li>
    <li>
      <a href="articles/start_here.html">Getting started predicting crosses</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolfemd/genomicMateSelectR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="genomic-mate-selection-in-r">Genomic Mate Selection in R<a class="anchor" aria-label="anchor" href="#genomic-mate-selection-in-r"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>Welcome to the R package that provides support for genomic-enabled prediction and mate selection for plant and animal breeding: <code><a href="https://github.com/wolfemd/genomicMateSelectR" class="external-link">library(genomicMateSelectR)</a></code>.</p>
<p>The primary functions of <code>genomicMateSelectR</code> predict the means and variances in performance among progeny of crosses based on parent data in order to support selection of mates in a breeding program. Supports diploid organisms with phased, chromosome- or linkage-group ordered biallelic marker data, and a centimorgan-scale genetic map. Additional functions automate cross-validation estimation of prediction accuracy, and more.</p>
<p>The package includes what might be too many extra functions. Indeed, it spans the entire pipeline used for <strong>genomic mate selection</strong> for the <a href="https://www.nextgencassava.org/" class="external-link">NextGen Cassava Breeding programs</a> using data downloads from <a href="https://www.cassavabase.org" class="external-link">Cassavabase</a>. Functions to: automate cross-validation procedures, compute accuracy on a selection index, make predictions of individual and cross performances on a multi-trait selection index. Prediction models including additive-effects only (“A”), additive-plus-dominance (“AD”) and a directional dominance model (“DirDom”). Functions used in cleaning and curating breeding pipeline field data <em>plus</em> handling and imputing genomics data are also included, but most users are not likely to find these of interest. Not everything has been equally tested or documented at this stage.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <a href="https://www.github.com/wolfemd/genomicMateSelectR/" class="external-link"><strong>genomicMateSelectR</strong> package from my GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"wolfemd/genomicMateSelectR"</span>, ref <span class="op">=</span> <span class="st">'master'</span><span class="op">)</span> </code></pre></div>
</div>
<div class="section level2">
<h2 id="get-started">Get Started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<p><strong>CHECK OUT THE NEW VIGNETTES!</strong></p>
<ol style="list-style-type: decimal">
<li><a href="articles/start_here.html">Getting starting predicting crosses</a></li>
<li><a href="articles/non_additive_models.html">Genomic (cross) predictions with non-additive effects</a></li>
</ol>
<p><strong>More to come!</strong></p>
</div>
<div class="section level2">
<h2 id="feature-highlights">Feature highlights<a class="anchor" aria-label="anchor" href="#feature-highlights"></a>
</h2>
<ul>
<li>Allows for parents to be of arbitrary heterozygosity/homozygosity (outbred or inbred)</li>
<li>Predicts the <strong>additive</strong> <em>and</em> <strong>dominance</strong> genetic variances in the <span class="math inline"><em>F</em><sub>1</sub></span>
</li>
<li>Support for a directional dominance model (<code>modelType="DirDom"</code>) to incorporate genome-wide homozygosity-effects (inbreeding) into predictions.</li>
<li>Predicts genetic <strong>variances</strong> <em>and</em> <strong><em>co</em></strong>-<strong>variances</strong>.</li>
<li>Support for multi-trait <strong>selection index</strong> via <code>selInd=TRUE</code> and <code>SIwts=</code> arguments.</li>
<li>Functions to implement parent-wise cross-validation as described in the paper, also for “standard” cross-validation</li>
<li>Handles simple (one trait, one cross) predictions, but built for complex (multi-trait, many crosses) scenarios.</li>
<li>Single estimate of marker effects from REML or MCMC (posterior mean effects –&gt; predicts “variance of posterior means”) supported</li>
<li>Posterior Mean Variance (PMV) <em>also</em> supported: the estimator of Lehermeier et al. 2017b which computes the predicted variance across a sample of marker effects, e.g. the thinned MCMC samples, usually stored on disk. For the multi-trait case, a multivariate Bayesian model is required as only a marker effects for each trait must be computed on the same Gibbs chain. <em>New version of cross variance predictions are not optimized for PMV so users wanted that are recommended to return to <code>predCrossVar</code></em>.</li>
<li>The relatively stable functions used to implement imputation and data cleaning for the NextGen Cassava Breeding GS programs.</li>
<li>Various data helper functions</li>
</ul>
</div>
<div class="section level2">
<h2 id="core-function-overview">Core function overview<a class="anchor" aria-label="anchor" href="#core-function-overview"></a>
</h2>
<table class="table">
<colgroup>
<col width="5%">
<col width="94%">
</colgroup>
<thead><tr class="header">
<th><strong>Genomic mate selection functions</strong></th>
<th>Top level functions to predict the performance of individual genotypes and the usefulness of potential crosses.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/runGenomicPredictions.html">runGenomicPredictions()</a></code></td>
<td>Run GBLUP model using <code><a href="https://rdrr.io/pkg/sommer/man/mmer.html" class="external-link">sommer::mmer</a></code>, potentially on multiple traits. Returns genomic BLUPs (GEBV and GETGV). If requested, returns backsolved marker effects (equivalent to ridge regression / SNP-BLUP).</td>
</tr>
<tr class="even">
<td><code><a href="reference/predictCrosses.html">predictCrosses()</a></code></td>
<td>Predict potentially for multiple traits, the means, variances and trait-trait covariances in a set of user-requested crosses-to-evaluate. Output enables easy ranking of potential crosses. Potentially computes the usefulness criteria, <span class="math inline"><em>U</em><em>C</em>_<em>p</em><em>a</em><em>r</em><em>e</em><em>n</em><em>t</em></span> and <span class="math inline"><em>U</em><em>C</em>_<em>v</em><em>a</em><em>r</em><em>i</em><em>e</em><em>t</em><em>y</em></span>. Provides users the option to predict cross usefulness (means and variances) on a linear multi-trait selection index, taking into account trait-trait covariances within each cross, using a set of user-supplied weights. Utilizes the functions <code><a href="reference/predCrossVars.html">predCrossVars()</a></code> and <code><a href="reference/predCrossMeans.html">predCrossMeans()</a></code> under-the-hood. This function is designed to work with <code><a href="reference/runGenomicPredictions.html">runGenomicPredictions()</a></code> , taking SNP-effects matrices output from that function.</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="17%">
<col width="82%">
</colgroup>
<thead><tr class="header">
<th><strong>Cross-validation functions</strong></th>
<th>Functions to automate cross-validation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/runParentWiseCrossVal.html">runParentWiseCrossVal()</a></code></td>
<td>Assess the accuracy of predicted previously unobserved crosses.</td>
</tr>
<tr class="even">
<td><code><a href="reference/runCrossVal.html">runCrossVal()</a></code></td>
<td>Run k-fold cross-validation and assess the accuracy of predicted previously unobserved genotypes (individuals) based on the available training data.</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="39%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th><strong>Cross-prediction functions</strong></th>
<th>Functions that predict cross means and variances</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/predCrossVars.html">predCrossVars()</a></code></td>
<td>Predict cross variances and covariances</td>
</tr>
<tr class="even">
<td><code><a href="reference/predCrossMeans.html">predCrossMeans()</a></code></td>
<td>Predict cross means</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="nextgen-cassava-gs-pipeline-functions">NextGen Cassava GS pipeline functions<a class="anchor" aria-label="anchor" href="#nextgen-cassava-gs-pipeline-functions"></a>
</h2>
<p>In addition, a host of functions developed to support processing both the field trial data stored on the <a href="https://www.cassavabase.org/" class="external-link">Cassavabase</a> and the genotyping/genomics data (imputation, file conversions).</p>
<p>There are two “families” of functions distinguished in the <a href="reference/index.html">Reference</a> as “cassavabase_pheno_pipeline” and “imputation_functions”.</p>
</div>
<div class="section level2">
<h2 id="relationship-to-predcrossvar">Relationship to <code>predCrossVar</code>
<a class="anchor" aria-label="anchor" href="#relationship-to-predcrossvar"></a>
</h2>
<p><code><a href="https://github.com/wolfemd/genomicMateSelectR" class="external-link">library(genomicMateSelectR)</a></code> descends from and extends the <a href="https://wolfemd.github.io/predCrossVar/" class="external-link"><strong>predCrossVar</strong></a> R package. <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(predCrossVar)</a></code> was build alongside an <a href="https://www.biorxiv.org/content/10.1101/2021.01.05.425443v1" class="external-link">an initial study</a>, which showed promising results regarding the prediction of genetic variance in cassava crosses. Subsequent to that initial study, the code was completed and improved. The considerable subsequent analyses leading to the functions collected in <code><a href="https://github.com/wolfemd/genomicMateSelectR" class="external-link">library(genomicMateSelectR)</a></code> are completely documented <a href="https://wolfemd.github.io/implementGMSinCassava/" class="external-link">here</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/wolfemd/genomicMateSelectR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wolfemd/genomicMateSelectR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing genomicMateSelectR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Marnin Wolfe <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Marnin Wolfe.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
